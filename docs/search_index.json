[["hayman-fire-recovery.html", "Chapter 3 Hayman Fire Recovery 3.1 Assignment", " Chapter 3 Hayman Fire Recovery Composed by Matt Ross ####---- Reading in Data and Stacking it -----#### #Reading in files #Couldn&#39;t knit this with the pathway used, so the entire file pathway was used. files &lt;- list.files(&#39;C:/Users/13074/Documents/ESS580/2_fire_data_wrangle/data&#39;,full.names=T) #Read in individual data files ndmi &lt;- read_csv(files[1]) %&gt;% rename(burned=2,unburned=3) %&gt;% mutate(data=&#39;ndmi&#39;) ndsi &lt;- read_csv(files[2]) %&gt;% rename(burned=2,unburned=3) %&gt;% mutate(data=&#39;ndsi&#39;) ndvi &lt;- read_csv(files[3])%&gt;% rename(burned=2,unburned=3) %&gt;% mutate(data=&#39;ndvi&#39;) # Stack as a tidy dataset full_long &lt;- rbind(ndvi,ndmi,ndsi) %&gt;% gather(key=&#39;site&#39;,value=&#39;value&#39;,-DateTime,-data) %&gt;% filter(!is.na(value)) 3.1 Assignment 3.1.1 Question 1: What is the correlation between NDVI and NDMI? - here I want you to convert the full_long dataset in to a wide dataset using the function spread and then make a plot that shows the correlation s a function of if the site was burned or not (x axis should be ndmi) You should exclude winter months and focus on summer months When the NDMI value increases, the NDVI increases as well. While the NDMI was at or below zero for most of the burned site, the NDVI largely does not extend past 0.35. In contrast, NDMI values begin below 0 for the unburned site and extends to about 0.2, with NDVI values ranging between 0.35 and 0.55. The figure suggests that unburned site with its higher vegetation index is able to retain moisture better than the burned site. #Converts the long format to wide, removes the resulting NAs from the df. full_wide &lt;- spread(full_long, data, value) %&gt;% filter_if(is.numeric, all_vars(!is.na(.))) #Filter for summer months only summer_fw &lt;- full_wide %&gt;% mutate(month = month(DateTime), year = year(DateTime)) %&gt;% filter(!month %in% c(10, 11, 12, 1, 2, 3, 4, 5)) ggplot(summer_fw, aes(x= ndmi, y= ndvi, color = site)) + geom_point(shape=7) + theme_base() + theme(legend.position = c(0.8,0.6)) + labs(x=&#39;NDMI&#39;, y=&quot;NDVI&quot;) 3.1.2 Question 2: What is the correlation between average NDSI (normalized snow index) for January - April and average NDVI for June-August? In other words, does the previous years snow cover influence vegetation growth for the following summer? Both sites demonstrate relatively flat trends between average winter NDSI and average summer NDVI. The difference between the two sites suggests that the amount of winter snow is not as important as a site having enough vegetation to sustain a higher summer NDVI. #For this, I want average NDSI for Jan-Apr, and average NDVI for Jun-Aug #Winter winter_ndsi &lt;- select(full_wide, &quot;DateTime&quot;, &quot;site&quot;, &quot;ndsi&quot;) %&gt;% mutate(month = month(DateTime), year = year(DateTime)) %&gt;% filter(month %in% c(1, 2, 3, 4)) %&gt;% group_by(site, year) %&gt;% summarise(ave_ndsi = mean(ndsi)) ## `summarise()` has grouped output by &#39;site&#39;. You can override using the `.groups` argument. #summer summer_ndvi &lt;- select(full_wide, &quot;DateTime&quot;, &quot;site&quot;, &quot;ndvi&quot;) %&gt;% mutate(month = month(DateTime), year = year(DateTime)) %&gt;% filter(month %in% c(6, 7, 8)) %&gt;% group_by(site, year) %&gt;% summarise(ave_ndvi = mean(ndvi)) ## `summarise()` has grouped output by &#39;site&#39;. You can override using the `.groups` argument. #Joining them together winter_summer &lt;- left_join(winter_ndsi, summer_ndvi) ## Joining, by = c(&quot;site&quot;, &quot;year&quot;) ggplot(winter_summer, aes(x= ave_ndsi, y= ave_ndvi, color = site)) + geom_point() + theme_base() + geom_smooth(method = &quot;lm&quot;) + theme(legend.position = c(0.85,0.3)) + labs(x=&#39;Average NDSI&#39;, y=&quot;Average NDVI&quot;) ## `geom_smooth()` using formula &#39;y ~ x&#39; 3.1.3 Question 3: How is the snow effect from question 2 different between pre- and post-burn and burned and unburned? At both sites, the average winter NDSI had little effect upon NDVI. After the fire, the burned site no longer had any vegetation to sustain, regardless of NDSI, so the NDVI is lower than the unburned site. #Want a facet wrap of the previous data splitting the difference between pre/post fire pre_post_winter_summer &lt;- winter_summer %&gt;% mutate(pre_post = ifelse(year &lt;2002, &quot;Before Burn&quot;, &quot;Post Burn&quot;)) ggplot(pre_post_winter_summer, aes(x= ave_ndsi, y= ave_ndvi, color = site)) + geom_point() + theme_base() + facet_wrap(~pre_post) + labs(x=&#39;Average NDSI&#39;, y=&quot;Average NDVI&quot;) 3.1.4 Question 4: What month is the greenest month on average? For the period of record for both sites, August is the greenest month with September not lagging far behind. # Mutate by month, then find the average NDVI. Bar chart. green_fw &lt;- full_wide %&gt;% mutate(month = month(DateTime, label = TRUE)) %&gt;% group_by(month) %&gt;% summarise(green= mean(ndvi)) ggplot(green_fw, aes(x= month, y= green)) + geom_bar(stat=&quot;identity&quot;, width=0.5, fill=&quot;dark green&quot;) + theme_base() + labs(x=&#39;Month&#39;, y=&quot;Average NDVI&quot;) 3.1.5 Question 5: What month is the snowiest on average? January on average is the snowiest month for the period of record. #Mutate by month, then find the average NDSI. Bar chart. snow_fw &lt;- full_wide %&gt;% mutate(month = month(DateTime, label = TRUE)) %&gt;% group_by(month) %&gt;% summarise(snow= mean(ndsi &gt; 0)) ggplot(snow_fw, aes(x= month, y= snow)) + geom_bar(stat=&quot;identity&quot;, width=0.5, fill=&quot;blue&quot;) + theme_base() + labs(x=&#39;Month&#39;, y=&quot;Average NDSI&quot;) 3.1.6 Bonus Question: Redo all problems with spread and gather using modern tidyverse syntax. Gather was initially used when reading in and stacking data, while spread was used in Question 1. The pertinent lines of code are replaced below: 3.1.7 Spread Spread to pivot_wider: full_wider &lt;- pivot_wider(full_long, names_from = data, values_from = value) %&gt;% filter_if(is.numeric, all_vars(!is.na(.))) 3.1.8 Gather Gather to pivot_longer: full_long2 &lt;- rbind(ndvi,ndmi,ndsi) %&gt;% pivot_longer(burned:unburned, names_to =&#39;site&#39;, values_to=&#39;value&#39;) %&gt;% filter(!is.na(value)) "]]
