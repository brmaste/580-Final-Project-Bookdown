<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Webscraping, iterations, and functions | 580 Final Project Bookdown</title>
  <meta name="description" content="Chapter 4 Webscraping, iterations, and functions | 580 Final Project Bookdown" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Webscraping, iterations, and functions | 580 Final Project Bookdown" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Webscraping, iterations, and functions | 580 Final Project Bookdown" />
  
  
  

<meta name="author" content="Brian Steen" />


<meta name="date" content="2022-03-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hayman-fire-recovery.html"/>
<link rel="next" href="geospatial-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">580 Final Project Bookdown</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="2" data-path="discharge-data-example.html"><a href="discharge-data-example.html"><i class="fa fa-check"></i><b>2</b> Discharge Data Example<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="discharge-data-example.html"><a href="discharge-data-example.html#methods"><i class="fa fa-check"></i><b>2.1</b> Methods<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="discharge-data-example.html"><a href="discharge-data-example.html#sitedescription"><i class="fa fa-check"></i><b>2.1.1</b> SiteDescription<span></span></a></li>
<li class="chapter" data-level="2.1.2" data-path="discharge-data-example.html"><a href="discharge-data-example.html#data-acquisition-and-plotting-tests"><i class="fa fa-check"></i><b>2.1.2</b> Data Acquisition and Plotting tests<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="discharge-data-example.html"><a href="discharge-data-example.html#assignment"><i class="fa fa-check"></i><b>2.2</b> Assignment<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="discharge-data-example.html"><a href="discharge-data-example.html#dygraph-example"><i class="fa fa-check"></i><b>2.2.1</b> DyGraph example<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="discharge-data-example.html"><a href="discharge-data-example.html#poudre-paragraph"><i class="fa fa-check"></i><b>2.2.2</b> Poudre Paragraph<span></span></a></li>
<li class="chapter" data-level="2.2.3" data-path="discharge-data-example.html"><a href="discharge-data-example.html#presentation-version-link"><i class="fa fa-check"></i><b>2.2.3</b> Presentation Version Link<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html"><i class="fa fa-check"></i><b>3</b> Hayman Fire Recovery<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#assignment-1"><i class="fa fa-check"></i><b>3.1</b> Assignment<span></span></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#question-1"><i class="fa fa-check"></i><b>3.1.1</b> Question 1:<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#question-2"><i class="fa fa-check"></i><b>3.1.2</b> Question 2:<span></span></a></li>
<li class="chapter" data-level="3.1.3" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#question-3"><i class="fa fa-check"></i><b>3.1.3</b> Question 3:<span></span></a></li>
<li class="chapter" data-level="3.1.4" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#question-4"><i class="fa fa-check"></i><b>3.1.4</b> Question 4:<span></span></a></li>
<li class="chapter" data-level="3.1.5" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#question-5"><i class="fa fa-check"></i><b>3.1.5</b> Question 5:<span></span></a></li>
<li class="chapter" data-level="3.1.6" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#bonus-question"><i class="fa fa-check"></i><b>3.1.6</b> Bonus Question:<span></span></a></li>
<li class="chapter" data-level="3.1.7" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#spread"><i class="fa fa-check"></i><b>3.1.7</b> Spread<span></span></a></li>
<li class="chapter" data-level="3.1.8" data-path="hayman-fire-recovery.html"><a href="hayman-fire-recovery.html#gather"><i class="fa fa-check"></i><b>3.1.8</b> Gather<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html"><i class="fa fa-check"></i><b>4</b> Webscraping, iterations, and functions<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#simple-web-scraping"><i class="fa fa-check"></i><b>4.1</b> Simple web scraping<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#reading-an-html"><i class="fa fa-check"></i><b>4.1.1</b> Reading an html<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#data-download-1"><i class="fa fa-check"></i><b>4.1.2</b> Data Download<span></span></a></li>
<li class="chapter" data-level="4.1.3" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#data-read-in"><i class="fa fa-check"></i><b>4.1.3</b> Data read-in<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#assignment-2"><i class="fa fa-check"></i><b>4.2</b> Assignment<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#question-1-1"><i class="fa fa-check"></i><b>4.2.1</b> Question 1:<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#question-2-1"><i class="fa fa-check"></i><b>4.2.2</b> Question 2:<span></span></a></li>
<li class="chapter" data-level="4.2.3" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#question-3-1"><i class="fa fa-check"></i><b>4.2.3</b> Question 3:<span></span></a></li>
<li class="chapter" data-level="4.2.4" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#question-4-1"><i class="fa fa-check"></i><b>4.2.4</b> Question 4:<span></span></a></li>
<li class="chapter" data-level="4.2.5" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#question-5-1"><i class="fa fa-check"></i><b>4.2.5</b> Question 5:<span></span></a></li>
<li class="chapter" data-level="4.2.6" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#question-6"><i class="fa fa-check"></i><b>4.2.6</b> Question 6:<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#bonus"><i class="fa fa-check"></i><b>4.3</b> Bonus<span></span></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#bonus-1"><i class="fa fa-check"></i><b>4.3.1</b> Bonus 1:<span></span></a></li>
<li class="chapter" data-level="4.3.2" data-path="webscraping-iterations-and-functions.html"><a href="webscraping-iterations-and-functions.html#bonus-2"><i class="fa fa-check"></i><b>4.3.2</b> Bonus 2:<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="geospatial-1.html"><a href="geospatial-1.html"><i class="fa fa-check"></i><b>5</b> Geospatial 1<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="geospatial-1.html"><a href="geospatial-1.html#lagos-analysis"><i class="fa fa-check"></i><b>5.1</b> LAGOS Analysis<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="geospatial-1.html"><a href="geospatial-1.html#loading-in-data"><i class="fa fa-check"></i><b>5.1.1</b> Loading in data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="geospatial-1.html"><a href="geospatial-1.html#assignment-3"><i class="fa fa-check"></i><b>5.2</b> Assignment<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="geospatial-1.html"><a href="geospatial-1.html#question-1-2"><i class="fa fa-check"></i><b>5.2.1</b> Question 1:<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="geospatial-1.html"><a href="geospatial-1.html#question-2-2"><i class="fa fa-check"></i><b>5.2.2</b> Question 2:<span></span></a></li>
<li class="chapter" data-level="5.2.3" data-path="geospatial-1.html"><a href="geospatial-1.html#question-3-2"><i class="fa fa-check"></i><b>5.2.3</b> Question 3:<span></span></a></li>
<li class="chapter" data-level="5.2.4" data-path="geospatial-1.html"><a href="geospatial-1.html#question-4-2"><i class="fa fa-check"></i><b>5.2.4</b> Question 4:<span></span></a></li>
<li class="chapter" data-level="5.2.5" data-path="geospatial-1.html"><a href="geospatial-1.html#question-5-2"><i class="fa fa-check"></i><b>5.2.5</b> Question 5:<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="geospatial-2.html"><a href="geospatial-2.html"><i class="fa fa-check"></i><b>6</b> Geospatial 2<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="geospatial-2.html"><a href="geospatial-2.html#lagos-analysis-1"><i class="fa fa-check"></i><b>6.1</b> LAGOS Analysis<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="geospatial-2.html"><a href="geospatial-2.html#loading-in-data-1"><i class="fa fa-check"></i><b>6.1.1</b> Loading in data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="geospatial-2.html"><a href="geospatial-2.html#assignment-4"><i class="fa fa-check"></i><b>6.2</b> Assignment<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="geospatial-2.html"><a href="geospatial-2.html#question-1a"><i class="fa fa-check"></i><b>6.2.1</b> Question 1a:<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="geospatial-2.html"><a href="geospatial-2.html#question-1.a"><i class="fa fa-check"></i><b>6.2.2</b> Question 1.a:<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="geospatial-2.html"><a href="geospatial-2.html#question-2-3"><i class="fa fa-check"></i><b>6.2.3</b> Question 2:<span></span></a></li>
<li class="chapter" data-level="6.2.4" data-path="geospatial-2.html"><a href="geospatial-2.html#question-2a"><i class="fa fa-check"></i><b>6.2.4</b> Question 2a:<span></span></a></li>
<li class="chapter" data-level="6.2.5" data-path="geospatial-2.html"><a href="geospatial-2.html#question-2b"><i class="fa fa-check"></i><b>6.2.5</b> Question 2b:<span></span></a></li>
<li class="chapter" data-level="6.2.6" data-path="geospatial-2.html"><a href="geospatial-2.html#question-2c"><i class="fa fa-check"></i><b>6.2.6</b> Question 2c:<span></span></a></li>
<li class="chapter" data-level="6.2.7" data-path="geospatial-2.html"><a href="geospatial-2.html#question-3-3"><i class="fa fa-check"></i><b>6.2.7</b> Question 3:<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html"><i class="fa fa-check"></i><b>7</b> Regressions using yield and temperature data<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#weather-data-analysis"><i class="fa fa-check"></i><b>7.1</b> Weather Data Analysis<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#load-the-prism-daily-maximum-temperatures"><i class="fa fa-check"></i><b>7.1.1</b> Load the PRISM daily maximum temperatures<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#temperature-trends"><i class="fa fa-check"></i><b>7.2</b> Temperature trends<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#summer-temperature-trends-winneshiek-county"><i class="fa fa-check"></i><b>7.2.1</b> Summer temperature trends: Winneshiek County<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#winter-temperatures---winneshiek-county"><i class="fa fa-check"></i><b>7.2.2</b> Winter Temperatures - Winneshiek County<span></span></a></li>
<li class="chapter" data-level="7.2.3" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#multiple-regression-quadratic-time-trend"><i class="fa fa-check"></i><b>7.2.3</b> Multiple regression – Quadratic time trend<span></span></a></li>
<li class="chapter" data-level="7.2.4" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#download-nass-corn-yield-data"><i class="fa fa-check"></i><b>7.2.4</b> Download NASS corn yield data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#assignment-5"><i class="fa fa-check"></i><b>7.3</b> Assignment<span></span></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#question-1a-1"><i class="fa fa-check"></i><b>7.3.1</b> Question 1a:<span></span></a></li>
<li class="chapter" data-level="7.3.2" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#question-1b"><i class="fa fa-check"></i><b>7.3.2</b> Question 1b:<span></span></a></li>
<li class="chapter" data-level="7.3.3" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#question-2-4"><i class="fa fa-check"></i><b>7.3.3</b> Question 2:<span></span></a></li>
<li class="chapter" data-level="7.3.4" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#question-3-4"><i class="fa fa-check"></i><b>7.3.4</b> Question 3:<span></span></a></li>
<li class="chapter" data-level="7.3.5" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#question-4-3"><i class="fa fa-check"></i><b>7.3.5</b> Question 4:<span></span></a></li>
<li class="chapter" data-level="7.3.6" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#question-5-3"><i class="fa fa-check"></i><b>7.3.6</b> Question 5:<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#bonus-3"><i class="fa fa-check"></i><b>7.4</b> Bonus<span></span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="regressions-using-yield-and-temperature-data.html"><a href="regressions-using-yield-and-temperature-data.html#bonus-1-1"><i class="fa fa-check"></i><b>7.4.1</b> Bonus 1:<span></span></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">580 Final Project Bookdown</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="webscraping-iterations-and-functions" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Webscraping, iterations, and functions<a href="webscraping-iterations-and-functions.html#webscraping-iterations-and-functions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Composed by Matt Ross</em></p>
<div id="simple-web-scraping" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Simple web scraping<a href="webscraping-iterations-and-functions.html#simple-web-scraping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R can read html using either rvest, xml, or xml2 packages. Here we are going to navigate to the Center for Snow and Avalance Studies <a href="https://snowstudies.org/archived-data/">Website</a> and read a table in. This table contains links to data we want to programatically download for three sites. We don’t know much about these sites, but they contain incredibly rich snow, temperature, and precip data.</p>
<div id="reading-an-html" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Reading an html<a href="webscraping-iterations-and-functions.html#reading-an-html" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="extract-csv-links-from-webpage" class="section level4 hasAnchor" number="4.1.1.1">
<h4><span class="header-section-number">4.1.1.1</span> Extract CSV links from webpage<a href="webscraping-iterations-and-functions.html#extract-csv-links-from-webpage" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="webscraping-iterations-and-functions.html#cb1-1" aria-hidden="true" tabindex="-1"></a>site_url <span class="ot">&lt;-</span> <span class="st">&#39;https://snowstudies.org/archived-data/&#39;</span></span>
<span id="cb1-2"><a href="webscraping-iterations-and-functions.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="webscraping-iterations-and-functions.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Read the web url</span></span>
<span id="cb1-4"><a href="webscraping-iterations-and-functions.html#cb1-4" aria-hidden="true" tabindex="-1"></a>webpage <span class="ot">&lt;-</span> <span class="fu">read_html</span>(site_url)</span>
<span id="cb1-5"><a href="webscraping-iterations-and-functions.html#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="webscraping-iterations-and-functions.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#See if we can extract tables and get the data that way</span></span>
<span id="cb1-7"><a href="webscraping-iterations-and-functions.html#cb1-7" aria-hidden="true" tabindex="-1"></a>tables <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb1-8"><a href="webscraping-iterations-and-functions.html#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&#39;table&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="webscraping-iterations-and-functions.html#cb1-9" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-10"><a href="webscraping-iterations-and-functions.html#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-11"><a href="webscraping-iterations-and-functions.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#That didn&#39;t work, so let&#39;s try a different approach</span></span>
<span id="cb1-12"><a href="webscraping-iterations-and-functions.html#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="webscraping-iterations-and-functions.html#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract only weblinks and then the URLs!</span></span>
<span id="cb1-14"><a href="webscraping-iterations-and-functions.html#cb1-14" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb1-15"><a href="webscraping-iterations-and-functions.html#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&#39;a&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-16"><a href="webscraping-iterations-and-functions.html#cb1-16" aria-hidden="true" tabindex="-1"></a>  .[<span class="fu">grepl</span>(<span class="st">&#39;24hr&#39;</span>,.)] <span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="webscraping-iterations-and-functions.html#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&#39;href&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="data-download-1" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Data Download<a href="webscraping-iterations-and-functions.html#data-download-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="download-data-in-a-for-loop" class="section level4 hasAnchor" number="4.1.2.1">
<h4><span class="header-section-number">4.1.2.1</span> Download data in a for loop<a href="webscraping-iterations-and-functions.html#download-data-in-a-for-loop" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="webscraping-iterations-and-functions.html#cb2-1" aria-hidden="true" tabindex="-1"></a>splits <span class="ot">&lt;-</span> <span class="fu">str_split_fixed</span>(links,<span class="st">&#39;/&#39;</span>,<span class="dv">8</span>)</span>
<span id="cb2-2"><a href="webscraping-iterations-and-functions.html#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="webscraping-iterations-and-functions.html#cb2-3" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> splits[,<span class="dv">8</span>] </span>
<span id="cb2-4"><a href="webscraping-iterations-and-functions.html#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="webscraping-iterations-and-functions.html#cb2-5" aria-hidden="true" tabindex="-1"></a>file_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;C:/Users/13074/Documents/ESS580/3_snow_functions_iteration/data&#39;</span>,dataset)</span>
<span id="cb2-6"><a href="webscraping-iterations-and-functions.html#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="webscraping-iterations-and-functions.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb2-8"><a href="webscraping-iterations-and-functions.html#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(links[i],<span class="at">destfile=</span>file_names[i])</span>
<span id="cb2-9"><a href="webscraping-iterations-and-functions.html#cb2-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-10"><a href="webscraping-iterations-and-functions.html#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="webscraping-iterations-and-functions.html#cb2-11" aria-hidden="true" tabindex="-1"></a>downloaded <span class="ot">&lt;-</span> <span class="fu">file.exists</span>(file_names)</span>
<span id="cb2-12"><a href="webscraping-iterations-and-functions.html#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="webscraping-iterations-and-functions.html#cb2-13" aria-hidden="true" tabindex="-1"></a>evaluate <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">all</span>(downloaded)</span></code></pre></div>
</div>
<div id="download-data-in-a-map" class="section level4 hasAnchor" number="4.1.2.2">
<h4><span class="header-section-number">4.1.2.2</span> Download data in a map<a href="webscraping-iterations-and-functions.html#download-data-in-a-map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="webscraping-iterations-and-functions.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(evaluate <span class="sc">==</span> T){</span>
<span id="cb3-2"><a href="webscraping-iterations-and-functions.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map2</span>(links[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],file_names[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],download.file)</span>
<span id="cb3-3"><a href="webscraping-iterations-and-functions.html#cb3-3" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{<span class="fu">print</span>(<span class="st">&#39;data already downloaded&#39;</span>)}</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0
## 
## [[2]]
## [1] 0
## 
## [[3]]
## [1] 0</code></pre>
</div>
</div>
<div id="data-read-in" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Data read-in<a href="webscraping-iterations-and-functions.html#data-read-in" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="read-in-just-the-snow-data-as-a-loop" class="section level4 hasAnchor" number="4.1.3.1">
<h4><span class="header-section-number">4.1.3.1</span> Read in just the snow data as a loop<a href="webscraping-iterations-and-functions.html#read-in-just-the-snow-data-as-a-loop" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="webscraping-iterations-and-functions.html#cb5-1" aria-hidden="true" tabindex="-1"></a>snow_files <span class="ot">&lt;-</span> file_names <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="webscraping-iterations-and-functions.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  .[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&#39;SG_24&#39;</span>,.)] <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="webscraping-iterations-and-functions.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  .[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&#39;PTSP&#39;</span>,.)]</span>
<span id="cb5-4"><a href="webscraping-iterations-and-functions.html#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="webscraping-iterations-and-functions.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#empty_data &lt;- list()</span></span>
<span id="cb5-6"><a href="webscraping-iterations-and-functions.html#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="webscraping-iterations-and-functions.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># snow_data &lt;- for(i in 1:length(snow_files)){</span></span>
<span id="cb5-8"><a href="webscraping-iterations-and-functions.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   empty_data[[i]] &lt;- read_csv(snow_files[i]) %&gt;%</span></span>
<span id="cb5-9"><a href="webscraping-iterations-and-functions.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     select(Year,DOY,Sno_Height_M)</span></span>
<span id="cb5-10"><a href="webscraping-iterations-and-functions.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb5-11"><a href="webscraping-iterations-and-functions.html#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="webscraping-iterations-and-functions.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#snow_data_full &lt;- do.call(&#39;rbind&#39;,empty_data)</span></span>
<span id="cb5-13"><a href="webscraping-iterations-and-functions.html#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="webscraping-iterations-and-functions.html#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(snow_data_full)</span></span></code></pre></div>
</div>
<div id="read-in-the-data-as-a-map-function" class="section level4 hasAnchor" number="4.1.3.2">
<h4><span class="header-section-number">4.1.3.2</span> Read in the data as a map function<a href="webscraping-iterations-and-functions.html#read-in-the-data-as-a-map-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="webscraping-iterations-and-functions.html#cb6-1" aria-hidden="true" tabindex="-1"></a>our_snow_reader <span class="ot">&lt;-</span> <span class="cf">function</span>(file){</span>
<span id="cb6-2"><a href="webscraping-iterations-and-functions.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  name <span class="ot">=</span> <span class="fu">str_split_fixed</span>(file,<span class="st">&#39;/&#39;</span>,<span class="dv">7</span>)[,<span class="dv">7</span>] <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="webscraping-iterations-and-functions.html#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gsub</span>(<span class="st">&#39;_24hr.csv&#39;</span>,<span class="st">&#39;&#39;</span>,.) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="webscraping-iterations-and-functions.html#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gsub</span>(<span class="st">&#39;data&#39;</span>, <span class="st">&#39;&#39;</span>,.)</span>
<span id="cb6-5"><a href="webscraping-iterations-and-functions.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(file) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="webscraping-iterations-and-functions.html#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Year,DOY,Sno_Height_M) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="webscraping-iterations-and-functions.html#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">site =</span> name)</span>
<span id="cb6-8"><a href="webscraping-iterations-and-functions.html#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="webscraping-iterations-and-functions.html#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="webscraping-iterations-and-functions.html#cb6-10" aria-hidden="true" tabindex="-1"></a>snow_data_full <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(snow_files,our_snow_reader)</span></code></pre></div>
<pre><code>## Rows: 6211 Columns: 52</code></pre>
<pre><code>## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl (52): ArrayID, Year, DOY, Hour, LoAir_Min_C, LoAir_Min_Time, LoAir_Max_C...</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre><code>## Rows: 6575 Columns: 48</code></pre>
<pre><code>## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl (48): ArrayID, Year, DOY, Hour, LoAir_Min_C, LoAir_Min_Time, LoAir_Max_C...</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="webscraping-iterations-and-functions.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(snow_data_full)</span></span></code></pre></div>
</div>
<div id="plot-snow-data" class="section level4 hasAnchor" number="4.1.3.3">
<h4><span class="header-section-number">4.1.3.3</span> Plot snow data<a href="webscraping-iterations-and-functions.html#plot-snow-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="webscraping-iterations-and-functions.html#cb14-1" aria-hidden="true" tabindex="-1"></a>snow_yearly <span class="ot">&lt;-</span> snow_data_full <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="webscraping-iterations-and-functions.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year,site) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="webscraping-iterations-and-functions.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_height =</span> <span class="fu">mean</span>(Sno_Height_M,<span class="at">na.rm=</span>T))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Year&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="webscraping-iterations-and-functions.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(snow_yearly,<span class="fu">aes</span>(<span class="at">x=</span>Year,<span class="at">y=</span>mean_height,<span class="at">color=</span>site)) <span class="sc">+</span> </span>
<span id="cb16-2"><a href="webscraping-iterations-and-functions.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-3"><a href="webscraping-iterations-and-functions.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span> </span>
<span id="cb16-4"><a href="webscraping-iterations-and-functions.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_few</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="assignment-2" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Assignment<a href="webscraping-iterations-and-functions.html#assignment-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="question-1-1" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Question 1:<a href="webscraping-iterations-and-functions.html#question-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Extract the meteorological data URLs. Here we want you to use the <code>rvest</code> package to get the URLs for the <code>SASP forcing</code> and <code>SBSP_forcing</code> meteorological datasets.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="webscraping-iterations-and-functions.html#cb18-1" aria-hidden="true" tabindex="-1"></a>site_url <span class="ot">&lt;-</span> <span class="st">&#39;https://snowstudies.org/archived-data/&#39;</span></span>
<span id="cb18-2"><a href="webscraping-iterations-and-functions.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="webscraping-iterations-and-functions.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Read the web url</span></span>
<span id="cb18-4"><a href="webscraping-iterations-and-functions.html#cb18-4" aria-hidden="true" tabindex="-1"></a>webpage <span class="ot">&lt;-</span> <span class="fu">read_html</span>(site_url)</span>
<span id="cb18-5"><a href="webscraping-iterations-and-functions.html#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="webscraping-iterations-and-functions.html#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract only weblinks and then the URLs!</span></span>
<span id="cb18-7"><a href="webscraping-iterations-and-functions.html#cb18-7" aria-hidden="true" tabindex="-1"></a>links_met <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="webscraping-iterations-and-functions.html#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&#39;a&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="webscraping-iterations-and-functions.html#cb18-9" aria-hidden="true" tabindex="-1"></a>  .[<span class="fu">grepl</span>(<span class="st">&#39;forcing&#39;</span>,.)] <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="webscraping-iterations-and-functions.html#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&#39;href&#39;</span>)</span></code></pre></div>
</div>
<div id="question-2-1" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Question 2:<a href="webscraping-iterations-and-functions.html#question-2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Download the meteorological data. Use the <code>download_file</code> and <code>str_split_fixed</code> commands to download the data and save it in your data folder. You can use a for loop or a map function.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="webscraping-iterations-and-functions.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grab only the name of the file by splitting out on forward slashes</span></span>
<span id="cb19-2"><a href="webscraping-iterations-and-functions.html#cb19-2" aria-hidden="true" tabindex="-1"></a>splits_met <span class="ot">&lt;-</span> <span class="fu">str_split_fixed</span>(links_met,<span class="st">&#39;/&#39;</span>,<span class="dv">8</span>)</span>
<span id="cb19-3"><a href="webscraping-iterations-and-functions.html#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="webscraping-iterations-and-functions.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Keep only the 8th column</span></span>
<span id="cb19-5"><a href="webscraping-iterations-and-functions.html#cb19-5" aria-hidden="true" tabindex="-1"></a>dataset_met <span class="ot">&lt;-</span> splits_met[,<span class="dv">8</span>] </span>
<span id="cb19-6"><a href="webscraping-iterations-and-functions.html#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="webscraping-iterations-and-functions.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a file list for where the data goes</span></span>
<span id="cb19-8"><a href="webscraping-iterations-and-functions.html#cb19-8" aria-hidden="true" tabindex="-1"></a>file_names_met <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;C:/Users/13074/Documents/ESS580/3_snow_functions_iteration/data&#39;</span>,dataset_met)</span>
<span id="cb19-9"><a href="webscraping-iterations-and-functions.html#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="webscraping-iterations-and-functions.html#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="webscraping-iterations-and-functions.html#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#This for loop takes the links_met list and adds a destination to it.</span></span>
<span id="cb19-12"><a href="webscraping-iterations-and-functions.html#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb19-13"><a href="webscraping-iterations-and-functions.html#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(links_met[i],<span class="at">destfile=</span>file_names_met[i])</span>
<span id="cb19-14"><a href="webscraping-iterations-and-functions.html#cb19-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-15"><a href="webscraping-iterations-and-functions.html#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="webscraping-iterations-and-functions.html#cb19-16" aria-hidden="true" tabindex="-1"></a>downloaded_met <span class="ot">&lt;-</span> <span class="fu">file.exists</span>(file_names_met)</span></code></pre></div>
</div>
<div id="question-3-1" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Question 3:<a href="webscraping-iterations-and-functions.html#question-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write a custom function to read in the data and append a site column to the data.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="webscraping-iterations-and-functions.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this code grabs the variable names from the metadata pdf file</span></span>
<span id="cb20-2"><a href="webscraping-iterations-and-functions.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pdftools)</span>
<span id="cb20-3"><a href="webscraping-iterations-and-functions.html#cb20-3" aria-hidden="true" tabindex="-1"></a>headers <span class="ot">&lt;-</span> <span class="fu">pdf_text</span>(<span class="st">&#39;https://snowstudies.org/wp-content/uploads/2022/02/Serially-Complete-Metadata-text08.pdf&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="webscraping-iterations-and-functions.html#cb20-4" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_lines</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="webscraping-iterations-and-functions.html#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">trimws</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="webscraping-iterations-and-functions.html#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_split_fixed</span>(.,<span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>,<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="webscraping-iterations-and-functions.html#cb20-7" aria-hidden="true" tabindex="-1"></a>  .[,<span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="webscraping-iterations-and-functions.html#cb20-8" aria-hidden="true" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>] <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="webscraping-iterations-and-functions.html#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_trim</span>(<span class="at">side =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb20-10"><a href="webscraping-iterations-and-functions.html#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="webscraping-iterations-and-functions.html#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">#headers</span></span>
<span id="cb20-12"><a href="webscraping-iterations-and-functions.html#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="webscraping-iterations-and-functions.html#cb20-13" aria-hidden="true" tabindex="-1"></a>file_names_met[]</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/13074/Documents/ESS580/3_snow_functions_iteration/dataSBB_SASP_Forcing_Data.txt&quot;
## [2] &quot;C:/Users/13074/Documents/ESS580/3_snow_functions_iteration/dataSBB_SBSP_Forcing_Data.txt&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="webscraping-iterations-and-functions.html#cb22-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> file_names_met[<span class="dv">1</span>]</span>
<span id="cb22-2"><a href="webscraping-iterations-and-functions.html#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="webscraping-iterations-and-functions.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reads in the data</span></span>
<span id="cb22-4"><a href="webscraping-iterations-and-functions.html#cb22-4" aria-hidden="true" tabindex="-1"></a>our_met_reader <span class="ot">&lt;-</span> <span class="cf">function</span>(file){</span>
<span id="cb22-5"><a href="webscraping-iterations-and-functions.html#cb22-5" aria-hidden="true" tabindex="-1"></a>  name <span class="ot">=</span> <span class="fu">str_split_fixed</span>(file,<span class="st">&#39;_&#39;</span>,<span class="dv">5</span>)[,<span class="dv">5</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="webscraping-iterations-and-functions.html#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gsub</span>(<span class="st">&#39;SP_Forcing_Data.txt&#39;</span>,<span class="st">&#39;&#39;</span>,.)</span>
<span id="cb22-7"><a href="webscraping-iterations-and-functions.html#cb22-7" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">read_fwf</span>(file) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="webscraping-iterations-and-functions.html#cb22-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setNames</span>(headers) <span class="sc">%&gt;%</span> </span>
<span id="cb22-9"><a href="webscraping-iterations-and-functions.html#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">siteID =</span>name)</span>
<span id="cb22-10"><a href="webscraping-iterations-and-functions.html#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="webscraping-iterations-and-functions.html#cb22-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="question-4-1" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Question 4:<a href="webscraping-iterations-and-functions.html#question-4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>map</code> function to read in both meteorological files. Display a summary of your tibble.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="webscraping-iterations-and-functions.html#cb23-1" aria-hidden="true" tabindex="-1"></a>file_names_met</span></code></pre></div>
<pre><code>## [1] &quot;C:/Users/13074/Documents/ESS580/3_snow_functions_iteration/dataSBB_SASP_Forcing_Data.txt&quot;
## [2] &quot;C:/Users/13074/Documents/ESS580/3_snow_functions_iteration/dataSBB_SBSP_Forcing_Data.txt&quot;</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="webscraping-iterations-and-functions.html#cb25-1" aria-hidden="true" tabindex="-1"></a>met_data_full <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(file_names_met,our_met_reader)</span>
<span id="cb25-2"><a href="webscraping-iterations-and-functions.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="webscraping-iterations-and-functions.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(met_data_full) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="webscraping-iterations-and-functions.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(.,<span class="st">&#39;html&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="webscraping-iterations-and-functions.html#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="webscraping-iterations-and-functions.html#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width=</span><span class="st">&#39;800px&#39;</span>,<span class="at">height=</span><span class="st">&#39;300px&#39;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:800px; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
month
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
day
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
hour
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
minute
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
second
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
precip [kg m-2 s-1]
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sw down [W m-2]
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lw down [W m-2]
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
air temp [K]
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
windspeed [m s-1]
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
relative humidity [%]
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
pressure [Pa]
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
specific humidity [g g-1]
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
calculated dewpoint temperature [K]
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
precip, WMO-corrected [kg m-2 s-1]
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
air temp, corrected with Kent et al. (1993) [K]
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
air temp, corrected with Anderson and Baumgartner (1998)[K]
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
air temp, corrected with Nakamura and Mahrt (2005) [K]
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
siteID
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
270.135
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:left;">
91.900
</td>
<td style="text-align:right;">
66863.46
</td>
<td style="text-align:left;">
4.189e-03 0
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
3000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4009
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
SA
</td>
</tr>
<tr>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0002778
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
269.923
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:left;">
93.000
</td>
<td style="text-align:right;">
66863.46
</td>
<td style="text-align:left;">
4.172e-03 0
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
3000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4009
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
SA
</td>
</tr>
<tr>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0002778
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
269.707
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:left;">
93.200
</td>
<td style="text-align:right;">
66863.46
</td>
<td style="text-align:left;">
4.114e-03 0
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
3000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4009
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
SA
</td>
</tr>
<tr>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0002778
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
269.552
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:left;">
93.400
</td>
<td style="text-align:right;">
66863.46
</td>
<td style="text-align:left;">
4.075e-03 0
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
3000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4009
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
SA
</td>
</tr>
<tr>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0008333
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
269.467
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:left;">
93.500
</td>
<td style="text-align:right;">
66863.46
</td>
<td style="text-align:left;">
4.053e-03 0
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
3000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4009
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
SA
</td>
</tr>
<tr>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0002778
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:right;">
269.392
</td>
<td style="text-align:right;">
-9999
</td>
<td style="text-align:left;">
93.500
</td>
<td style="text-align:right;">
66863.46
</td>
<td style="text-align:left;">
4.030e-03 0
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
3000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4009
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
SA
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="question-5-1" class="section level3 hasAnchor" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Question 5:<a href="webscraping-iterations-and-functions.html#question-5-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Make a line plot of mean temp by year by site (using the <code>air temp [K]</code> variable). Is there anything suspicious in the plot? Adjust your filtering if needed.</p>
<p><em>Some of the sensors seemed to be offline during 2003-2004 which was affecting the temperature sensor. These years were filtered out.</em> <em>Air temperature across both Senator Beck and Swamp Angel sites show increases in temperature during the period of record. Similarity in temperature patterns are likely due to the sites’ proximity to each other.</em></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="webscraping-iterations-and-functions.html#cb26-1" aria-hidden="true" tabindex="-1"></a>mean_a_t_k <span class="ot">&lt;-</span> met_data_full <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="webscraping-iterations-and-functions.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">air_temp_K =</span> <span class="st">&quot;air temp [K]&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="webscraping-iterations-and-functions.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;</span> <span class="dv">2004</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="webscraping-iterations-and-functions.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,siteID) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="webscraping-iterations-and-functions.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_a_t_k =</span> <span class="fu">mean</span>(air_temp_K,<span class="at">na.rm=</span>T))</span>
<span id="cb26-6"><a href="webscraping-iterations-and-functions.html#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="webscraping-iterations-and-functions.html#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mean_a_t_k,<span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">y=</span>mean_a_t_k,<span class="at">color=</span>siteID)) <span class="sc">+</span> </span>
<span id="cb26-8"><a href="webscraping-iterations-and-functions.html#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="webscraping-iterations-and-functions.html#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_base</span>() <span class="sc">+</span> </span>
<span id="cb26-10"><a href="webscraping-iterations-and-functions.html#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_few</span>() <span class="sc">+</span></span>
<span id="cb26-11"><a href="webscraping-iterations-and-functions.html#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm) <span class="sc">+</span></span>
<span id="cb26-12"><a href="webscraping-iterations-and-functions.html#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Year&#39;</span>, <span class="at">y=</span><span class="st">&quot;Air Temperature [K]&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="question-6" class="section level3 hasAnchor" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> Question 6:<a href="webscraping-iterations-and-functions.html#question-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write a function that makes line plots of monthly average temperature at each site for a given year. Use a for loop to make these plots for 2005 to 2010. Are monthly average temperatures at the Senator Beck Study Plot ever warmer than the Snow Angel Study Plot?
Hint: <a href="https://ggplot2.tidyverse.org/reference/print.ggplot.html" class="uri">https://ggplot2.tidyverse.org/reference/print.ggplot.html</a></p>
<p><em>Both Swamp Angel Senator Beck sites demonstrate temperature fluctuation typical of high elevation locations in the northern hemisphere. Similarity in temperature patterns are likely due to the sites’ proximity to each other.</em></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="webscraping-iterations-and-functions.html#cb27-1" aria-hidden="true" tabindex="-1"></a>plot_figure_k <span class="ot">&lt;-</span> <span class="cf">function</span>(df, year) {</span>
<span id="cb27-2"><a href="webscraping-iterations-and-functions.html#cb27-2" aria-hidden="true" tabindex="-1"></a>mean_month_a_t_k <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="webscraping-iterations-and-functions.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">air_temp_K =</span> <span class="st">&quot;air temp [K]&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="webscraping-iterations-and-functions.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(month, <span class="at">label =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="webscraping-iterations-and-functions.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(yr <span class="sc">==</span> year) <span class="sc">%&gt;%</span> </span>
<span id="cb27-6"><a href="webscraping-iterations-and-functions.html#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,month,siteID) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="webscraping-iterations-and-functions.html#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_a_t_k =</span> <span class="fu">mean</span>(air_temp_K,<span class="at">na.rm=</span>T)) </span>
<span id="cb27-8"><a href="webscraping-iterations-and-functions.html#cb27-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-9"><a href="webscraping-iterations-and-functions.html#cb27-9" aria-hidden="true" tabindex="-1"></a>figure_k <span class="ot">&lt;-</span></span>
<span id="cb27-10"><a href="webscraping-iterations-and-functions.html#cb27-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(mean_month_a_t_k,<span class="fu">aes</span>(<span class="at">x=</span>month,<span class="at">y=</span>mean_a_t_k,<span class="at">color=</span>siteID)) <span class="sc">+</span> </span>
<span id="cb27-11"><a href="webscraping-iterations-and-functions.html#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-12"><a href="webscraping-iterations-and-functions.html#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_base</span>() <span class="sc">+</span> </span>
<span id="cb27-13"><a href="webscraping-iterations-and-functions.html#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_few</span>() <span class="sc">+</span></span>
<span id="cb27-14"><a href="webscraping-iterations-and-functions.html#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Month&#39;</span>, <span class="at">y=</span><span class="st">&quot;Air Temp [K]&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-15"><a href="webscraping-iterations-and-functions.html#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year)</span>
<span id="cb27-16"><a href="webscraping-iterations-and-functions.html#cb27-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-17"><a href="webscraping-iterations-and-functions.html#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(figure_k)</span>
<span id="cb27-18"><a href="webscraping-iterations-and-functions.html#cb27-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-19"><a href="webscraping-iterations-and-functions.html#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="webscraping-iterations-and-functions.html#cb27-20" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2005</span><span class="sc">:</span><span class="dv">2011</span>)</span>
<span id="cb27-21"><a href="webscraping-iterations-and-functions.html#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="webscraping-iterations-and-functions.html#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (yr <span class="cf">in</span> years){</span>
<span id="cb27-23"><a href="webscraping-iterations-and-functions.html#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_figure_k</span>(met_data_full, year)</span>
<span id="cb27-24"><a href="webscraping-iterations-and-functions.html#cb27-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-12-1.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-12-2.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-12-3.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-12-4.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-12-5.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-12-6.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-12-7.png" width="672" /></p>
</div>
</div>
<div id="bonus" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Bonus<a href="webscraping-iterations-and-functions.html#bonus" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="bonus-1" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Bonus 1:<a href="webscraping-iterations-and-functions.html#bonus-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Make a plot of average daily precipitation by day of year (averaged across all available years). Color each site.</p>
<p><em>Site specific precipitation was unavailable, so the precipitation shown is for both Senator Beck and Swamp Angel study sites. Average precipitation follows a typical annual cycle for the Southern Rocky Mountains, with higher seasonal precipitation in the late summer.</em></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="webscraping-iterations-and-functions.html#cb28-1" aria-hidden="true" tabindex="-1"></a>precip <span class="ot">&lt;-</span> met_data_full <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="webscraping-iterations-and-functions.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">make_date</span>(year, month, day)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="webscraping-iterations-and-functions.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date))<span class="sc">%&gt;%</span> </span>
<span id="cb28-4"><a href="webscraping-iterations-and-functions.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">doy =</span> <span class="fu">yday</span>(date)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-5"><a href="webscraping-iterations-and-functions.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">precip_unit_area =</span> <span class="st">&quot;precip [kg m-2 s-1]&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="webscraping-iterations-and-functions.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">precip_mm =</span> precip_unit_area<span class="sc">*</span><span class="dv">86400</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-7"><a href="webscraping-iterations-and-functions.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(doy) <span class="sc">%&gt;%</span> </span>
<span id="cb28-8"><a href="webscraping-iterations-and-functions.html#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">average_precip =</span> <span class="fu">mean</span>(precip_mm))</span>
<span id="cb28-9"><a href="webscraping-iterations-and-functions.html#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="webscraping-iterations-and-functions.html#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(precip,<span class="fu">aes</span>(<span class="at">x=</span>doy,<span class="at">y=</span>average_precip)) <span class="sc">+</span> </span>
<span id="cb28-11"><a href="webscraping-iterations-and-functions.html#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-12"><a href="webscraping-iterations-and-functions.html#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_base</span>() <span class="sc">+</span> </span>
<span id="cb28-13"><a href="webscraping-iterations-and-functions.html#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Day of Year&#39;</span>, <span class="at">y=</span><span class="st">&quot;Average Precipitation (mm)&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="bonus-2" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Bonus 2:<a href="webscraping-iterations-and-functions.html#bonus-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use a function and for loop to create yearly plots of precipitation by day of year. Color each site.</p>
<p><em>Site specific precipitation was unavailable, so the precipitation shown is for both Senator Beck and Swamp Angel study sites. Precipitation for 2005-2011 follows a typical annual cycle for the Southern Rocky Mountains, with higher seasonal precipitation in mid to late summer.</em></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="webscraping-iterations-and-functions.html#cb29-1" aria-hidden="true" tabindex="-1"></a>plot_figure_prcp <span class="ot">&lt;-</span> <span class="cf">function</span>(df, year) {</span>
<span id="cb29-2"><a href="webscraping-iterations-and-functions.html#cb29-2" aria-hidden="true" tabindex="-1"></a>precip_doy <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="webscraping-iterations-and-functions.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">make_date</span>(year, month, day)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="webscraping-iterations-and-functions.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date))<span class="sc">%&gt;%</span> </span>
<span id="cb29-5"><a href="webscraping-iterations-and-functions.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">doy =</span> <span class="fu">yday</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="webscraping-iterations-and-functions.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(yr <span class="sc">==</span> year) <span class="sc">%&gt;%</span> </span>
<span id="cb29-7"><a href="webscraping-iterations-and-functions.html#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">precip_unit_area =</span> <span class="st">&quot;precip [kg m-2 s-1]&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="webscraping-iterations-and-functions.html#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">precip_mm =</span> precip_unit_area<span class="sc">*</span><span class="dv">86400</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-9"><a href="webscraping-iterations-and-functions.html#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(doy, year)</span>
<span id="cb29-10"><a href="webscraping-iterations-and-functions.html#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="webscraping-iterations-and-functions.html#cb29-11" aria-hidden="true" tabindex="-1"></a>figure_prcp <span class="ot">&lt;-</span></span>
<span id="cb29-12"><a href="webscraping-iterations-and-functions.html#cb29-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(precip_doy,<span class="fu">aes</span>(<span class="at">x=</span>doy,<span class="at">y=</span>precip_mm)) <span class="sc">+</span> </span>
<span id="cb29-13"><a href="webscraping-iterations-and-functions.html#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-14"><a href="webscraping-iterations-and-functions.html#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_base</span>() <span class="sc">+</span> </span>
<span id="cb29-15"><a href="webscraping-iterations-and-functions.html#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_few</span>() <span class="sc">+</span></span>
<span id="cb29-16"><a href="webscraping-iterations-and-functions.html#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Day of Year&#39;</span>, <span class="at">y=</span><span class="st">&quot;Precipitation (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-17"><a href="webscraping-iterations-and-functions.html#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year)</span>
<span id="cb29-18"><a href="webscraping-iterations-and-functions.html#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="webscraping-iterations-and-functions.html#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(figure_prcp)</span>
<span id="cb29-20"><a href="webscraping-iterations-and-functions.html#cb29-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-21"><a href="webscraping-iterations-and-functions.html#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="webscraping-iterations-and-functions.html#cb29-22" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2005</span><span class="sc">:</span><span class="dv">2011</span>)</span>
<span id="cb29-23"><a href="webscraping-iterations-and-functions.html#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="webscraping-iterations-and-functions.html#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (yr <span class="cf">in</span> years){</span>
<span id="cb29-25"><a href="webscraping-iterations-and-functions.html#cb29-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_figure_prcp</span>(met_data_full, year)</span>
<span id="cb29-26"><a href="webscraping-iterations-and-functions.html#cb29-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-14-1.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-14-2.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-14-3.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-14-4.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-14-5.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-14-6.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-14-7.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hayman-fire-recovery.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geospatial-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/brmaste/580-Final-Project-Bookdown/edit/master/04-Webscraping.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/brmaste/580-Final-Project-Bookdown/blob/master/04-Webscraping.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
